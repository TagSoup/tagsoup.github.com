
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Pest Control 2: Electric Boogaloo - Phx Tag Soup</title>
  <meta name="author" content="Phx Tag Soup">

  
  <meta name="description" content="Day 12 of the 30 Day Writing Challenge: Hello, I&#8217;m Truett Kueck and you&#8217;re not. Today I am going to expand on what I wrote about last &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://TagSoup.github.com/blog/2012/03/06/pest-control-2-electric-boogaloo/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Phx Tag Soup" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26533764-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Phx Tag Soup</a></h1>
  
    <h2>The soup is warm</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:TagSoup.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Pest Control 2: Electric Boogaloo</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-06T22:36:00-07:00" pubdate data-updated="true">Mar 6<span>th</span>, 2012</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h3>Day 12 of the 30 Day Writing Challenge:</h3>

<p>Hello, I&#8217;m Truett Kueck and you&#8217;re not.  Today I am going to expand on what I wrote about last week.  It is amazingly common to forget to add urls to links.  This is completely understandable.  You are developing the page in sprints, and sometimes the page you need to link to does not exist yet.  Multiple sprints later when that page exists it slips your mind and then BAM! a site is live with scores of non-functioning.  It is also possible, and very common, that the actual requirements for links are unclear or completely non-existent.</p>

<p>To solve this problem I have developed a simple Ruby application that parses a page for any links and then generates a Selenium script that clicks through the links on the page.  You will still need to make a few modifications, but you are 95% of the way there.  It uses the mechanize gem, another of many web automation gems, so we will need to install that first.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">sudo</span> <span class="n">gem</span> <span class="n">install</span> <span class="n">mechanize</span>
</span></code></pre></td></tr></table></div></figure>


<p>Mechanize is actually completely capable of performing the functionality of the Selenium script, but it has one major disadvantage.  The Selenium script can be run against Saucelab&#8217;s <a href="http://www.saucelabs.com">OnDemandService</a> which gives you access to most every major OS/Browser combination.  That might not matter to you as a developer, but Compatibility Testing is the bread and butter of QA.  Now onto the code:</p>

<!--more-->




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;mechanize&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">puts</span> <span class="s1">&#39;Please enter the url you\&#39;d like to create a Selenium script for.&#39;</span>
</span><span class='line'><span class="n">url</span> <span class="o">=</span> <span class="nb">gets</span><span class="o">.</span><span class="n">chomp</span>
</span><span class='line'><span class="nb">puts</span> <span class="s1">&#39;What would you like to name the script?&#39;</span>
</span><span class='line'><span class="n">filename</span> <span class="o">=</span> <span class="nb">gets</span><span class="o">.</span><span class="n">chomp</span>
</span><span class='line'>
</span><span class='line'><span class="n">agent</span> <span class="o">=</span> <span class="no">Mechanize</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">page</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span><span class='line'><span class="n">script</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.rb&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">pageLinks</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'><span class="n">page</span><span class="o">.</span><span class="n">links</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">link</span><span class="o">|</span>
</span><span class='line'>  <span class="n">pageLinks</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;require \&#39;rubygems\&#39;&#39;</span>
</span><span class='line'><span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;require \&#39;selenium-webdriver\&#39;&#39;</span>
</span><span class='line'><span class="n">script</span><span class="o">.</span><span class="n">puts</span>
</span><span class='line'><span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;page = Selenium::WebDriver.for :firefox&#39;</span>
</span><span class='line'><span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;page.get(\&#39;&#39;</span> <span class="o">+</span> <span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;\&#39;)&#39;</span>
</span><span class='line'><span class="n">script</span><span class="o">.</span><span class="n">puts</span>
</span><span class='line'>
</span><span class='line'><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="n">pageLinks</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">link</span><span class="o">|</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;link&#39;</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">to_s</span> <span class="o">+</span> <span class="s1">&#39; = page.find_element(:link_text, \&#39;&#39;</span> <span class="o">+</span> <span class="n">link</span> <span class="o">+</span> <span class="s1">&#39;\&#39;)&#39;</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;link&#39;</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">to_s</span> <span class="o">+</span> <span class="s1">&#39;.click&#39;</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;if page.title != PUT PAGE TITLE HERE&#39;</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39; puts \&#39;Test failed\&#39;&#39;</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;else&#39;</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39; puts \&#39;Test Passed\&#39;&#39;</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;end&#39;</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;page.quit&#39;</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;page.get(\&#39;&#39;</span> <span class="o">+</span><span class="n">url</span> <span class="o">+</span><span class="s1">&#39;\&#39;)&#39;</span>
</span><span class='line'>  <span class="n">script</span><span class="o">.</span><span class="n">puts</span>
</span><span class='line'>  <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The user is initially prompted to enter the url they would like to run against.  This does require the url to be entered in http://www.url.com format, but you can add in error checking fairly easily.  They are then asked what they would like to name the script.  Then magic happens and we end up with a nearly ready-made Selenium script.  Now we need to update the script to actually check that the links are working.  The outputted code for a given link should look like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">link0</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="ss">:link_text</span><span class="p">,</span> <span class="s1">&#39;Images&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">link0</span><span class="o">.</span><span class="n">click</span>
</span><span class='line'><span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">title</span> <span class="o">!=</span> <span class="no">PUT</span> <span class="no">PAGE</span> <span class="no">TITLE</span> <span class="no">HERE</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s1">&#39;Test failed&#39;</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s1">&#39;Test Passed&#39;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">page</span><span class="o">.</span><span class="n">quit</span>
</span><span class='line'><span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.google.com&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The angry caps locked, &#8220;PUT PAGE TITLE HERE,&#8221; is our target.  As I mentioned in the previous article: Selenium is capable of checking for things on the page other than the title.  If the link goes to content that is hidden, you can check for specific text.  Whichever you use replace that text with what you are looking for, and you are done.  Now go fourth and fix broken links.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Truett Kueck</span></span>

      








  


<time datetime="2012-03-06T22:36:00-07:00" pubdate data-updated="true">Mar 6<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/qa/'>QA</a>, <a class='category' href='/blog/categories/shut-up-truett/'>Shut Up Truett</a>, <a class='category' href='/blog/categories/writing-challenge/'>Writing Challenge</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://TagSoup.github.com/blog/2012/03/06/pest-control-2-electric-boogaloo/" data-via="phxtagsoup" data-counturl="http://TagSoup.github.com/blog/2012/03/06/pest-control-2-electric-boogaloo/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/03/05/emacs-and-i-are-bffs/" title="Previous Post: Emacs and I are BFF's">&laquo; Emacs and I are BFF's</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/03/07/bitwise-guy-are-ya/" title="Next Post: Bitwise Guy Are Ya?">Bitwise Guy Are Ya? &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Join Up</h1>
  <ul id="recent_posts">
      <li class="post">
        <a href="http://www.meetup.com/PHX-Tag-Soup/">Phx Tag Soup Meetups</a>
      </li>
  </ul>
</section><section>
  <h1>Find Us On:</h1>
  <ul id="recent_posts">
      <li class="post">
        <a href="http://www.facebook.com/PHXTagSoup">FaceBook</a>
      </li>
      <li class="post">
        <a href="https://twitter.com/#!/phxtagsoup">Twitter</a>
      </li>
      <li class="post">
        <a href="https://github.com/TagSoup/tagsoup.github.com">github</a>
      </li>
      <li class="post">
        <a href="https://groups.google.com/forum/?fromgroups#!forum/phx-tag-soup">google groups</a>
      </li>
      <li class="post">
        <a href="http://www.youtube.com/phxtagsoup">youTube</a>
      </li>
  </ul>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/10/09/meeting-announcement/">Meeting Announcement</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/18/weekly-meeting/">Weekly Meeting</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/12/july-12th-meet-up/">July 12th Meet Up</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/27/looking-for-a-job/">Looking for a job?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/20/weekly-meeting-details/">Weekly Meeting Details</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/tagsoup">@tagsoup</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'tagsoup',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("phxtagsoup", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/phxtagsoup" class="twitter-follow-button" data-show-count="false">Follow @phxtagsoup</a>
  
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Phx Tag Soup -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phxtagsoup';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://TagSoup.github.com/blog/2012/03/06/pest-control-2-electric-boogaloo/';
        var disqus_url = 'http://TagSoup.github.com/blog/2012/03/06/pest-control-2-electric-boogaloo/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
